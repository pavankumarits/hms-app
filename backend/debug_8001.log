INFO:     Will watch for changes in these directories: ['C:\\hms\\Project1\\backend']
INFO:     Uvicorn running on http://127.0.0.1:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [6572] using WatchFiles
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:     Started server process [11288]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'verify_id_logic.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11288]
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:     Started server process [12096]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
DEBUG LOGIN Attempt: username='admin', password='pass111'
INFO:     127.0.0.1:56734 - "POST /api/v1/login/access-token HTTP/1.1" 200 OK
Conflict resolved. New ID: P20251227-9002
INFO:     127.0.0.1:56737 - "POST /api/v1/patients/ HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\app\api\endpoints\patients.py", line 56, in create_patient
    hospital_id=current_user.hospital_id,
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 828, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
        session,
    ...<4 lines>...
        no_autoflush=no_autoflush,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 695, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1363, in _checkout
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1301, in _checkout
    result = pool._dialect._do_ping_w_event(
        fairy.dbapi_connection
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 729, in _do_ping_w_event
    return self.do_ping(dbapi_connection)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\dialects\mysql\pymysql.py", line 121, in do_ping
    dbapi_connection.ping(False)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 96, in ping
    self.await_(self._connection.ping(reconnect))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
Conflict resolved. New ID: P20251227-9002
INFO:     127.0.0.1:56739 - "POST /api/v1/patients/ HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\app\api\endpoints\patients.py", line 56, in create_patient
    hospital_id=current_user.hospital_id,
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 828, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
        session,
    ...<4 lines>...
        no_autoflush=no_autoflush,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 695, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1363, in _checkout
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1301, in _checkout
    result = pool._dialect._do_ping_w_event(
        fairy.dbapi_connection
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 729, in _do_ping_w_event
    return self.do_ping(dbapi_connection)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\dialects\mysql\pymysql.py", line 121, in do_ping
    dbapi_connection.ping(False)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 96, in ping
    self.await_(self._connection.ping(reconnect))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
WARNING:  WatchFiles detected changes in 'app\db\session.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [12096]
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
C:\hms\Project1\backend\venv\Lib\site-packages\pydantic\_internal\_config.py:383: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:     Started server process [11700]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
DEBUG LOGIN Attempt: username='admin', password='pass111'
INFO:     127.0.0.1:56799 - "POST /api/v1/login/access-token HTTP/1.1" 200 OK
Conflict resolved. New ID: P20251227-9002
INFO:     127.0.0.1:56811 - "POST /api/v1/patients/ HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\app\api\endpoints\patients.py", line 56, in create_patient
    hospital_id=current_user.hospital_id,
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 828, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
        session,
    ...<4 lines>...
        no_autoflush=no_autoflush,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 695, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str(statement), parameters, None, None
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.StatementError: (sqlalchemy.exc.MissingGreenlet) greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place?
[SQL: SELECT users.id AS users_id, users.hospital_id AS users_hospital_id, users.username AS users_username, users.hashed_password AS users_hashed_password, users.`role` AS users_role, users.is_active AS users_is_active 
FROM users 
WHERE users.id = %s]
[parameters: [{'pk_1': 'e6dec44c-70d6-4b49-9c7f-63b41ee00e9a'}]]
(Background on this error at: https://sqlalche.me/e/20/xd2s)
Conflict resolved. New ID: P20251227-9002
INFO:     127.0.0.1:56813 - "POST /api/v1/patients/ HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\app\api\endpoints\patients.py", line 56, in create_patient
    hospital_id=current_user.hospital_id,
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 828, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
        session,
    ...<4 lines>...
        no_autoflush=no_autoflush,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 695, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str(statement), parameters, None, None
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.StatementError: (sqlalchemy.exc.MissingGreenlet) greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place?
[SQL: SELECT users.id AS users_id, users.hospital_id AS users_hospital_id, users.username AS users_username, users.hashed_password AS users_hashed_password, users.`role` AS users_role, users.is_active AS users_is_active 
FROM users 
WHERE users.id = %s]
[parameters: [{'pk_1': 'e6dec44c-70d6-4b49-9c7f-63b41ee00e9a'}]]
(Background on this error at: https://sqlalche.me/e/20/xd2s)
DEBUG LOGIN Attempt: username='admin', password='pass111'
INFO:     127.0.0.1:56826 - "POST /api/v1/login/access-token HTTP/1.1" 200 OK
Conflict resolved. New ID: P20251227-9002
INFO:     127.0.0.1:56830 - "POST /api/v1/patients/ HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\app\api\endpoints\patients.py", line 56, in create_patient
    hospital_id=current_user.hospital_id,
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 828, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
        session,
    ...<4 lines>...
        no_autoflush=no_autoflush,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 695, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str(statement), parameters, None, None
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.StatementError: (sqlalchemy.exc.MissingGreenlet) greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place?
[SQL: SELECT users.id AS users_id, users.hospital_id AS users_hospital_id, users.username AS users_username, users.hashed_password AS users_hashed_password, users.`role` AS users_role, users.is_active AS users_is_active 
FROM users 
WHERE users.id = %s]
[parameters: [{'pk_1': 'e6dec44c-70d6-4b49-9c7f-63b41ee00e9a'}]]
(Background on this error at: https://sqlalche.me/e/20/xd2s)
Conflict resolved. New ID: P20251227-9002
INFO:     127.0.0.1:56832 - "POST /api/v1/patients/ HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\hms\Project1\backend\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\app\api\endpoints\patients.py", line 56, in create_patient
    hospital_id=current_user.hospital_id,
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 828, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
        session,
    ...<4 lines>...
        no_autoflush=no_autoflush,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 695, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str(statement), parameters, None, None
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
        dialect, self, conn, execution_options, *args, **kw
    )
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1438, in _init_compiled
    self.cursor = self.create_cursor()
                  ~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1777, in create_cursor
    return self.create_default_cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1783, in create_default_cursor
    return self._dbapi_connection.cursor()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1486, in cursor
    return self.dbapi_connection.cursor(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 353, in cursor
    return self._cursor_cls(self)
           ~~~~~~~~~~~~~~~~^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 153, in __init__
    self._cursor = self._aenter_cursor(cursor)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 159, in _aenter_cursor
    return self.await_(cursor.__aenter__())  # type: ignore[no-any-return]
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\hms\Project1\backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
    ...<2 lines>...
    )
sqlalchemy.exc.StatementError: (sqlalchemy.exc.MissingGreenlet) greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place?
[SQL: SELECT users.id AS users_id, users.hospital_id AS users_hospital_id, users.username AS users_username, users.hashed_password AS users_hashed_password, users.`role` AS users_role, users.is_active AS users_is_active 
FROM users 
WHERE users.id = %s]
[parameters: [{'pk_1': 'e6dec44c-70d6-4b49-9c7f-63b41ee00e9a'}]]
(Background on this error at: https://sqlalche.me/e/20/xd2s)
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11700]
Exception ignored in: <function Connection.__del__ at 0x000002703A4420C0>
Traceback (most recent call last):
  File "C:\hms\Project1\backend\venv\Lib\site-packages\aiomysql\connection.py", line 1131, in __del__
  File "C:\hms\Project1\backend\venv\Lib\site-packages\aiomysql\connection.py", line 339, in close
  File "C:\Users\pavan\AppData\Local\Programs\Python\Python313\Lib\asyncio\selector_events.py", line 1205, in close
  File "C:\Users\pavan\AppData\Local\Programs\Python\Python313\Lib\asyncio\selector_events.py", line 865, in close
  File "C:\Users\pavan\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 833, in call_soon
  File "C:\Users\pavan\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 556, in _check_closed
RuntimeError: Event loop is closed
